<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="keywords" content="花,听花,lestenflower,鲜花,鲜花订阅,混合花束包月套餐">
    <meta name="description" content="一周一花，用鲜花点亮生活,提供98元单品鲜花包月服务、168元混合鲜花包月服务和花艺周边配件、花艺课程服务。">
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <title>确认订单</title>
    <link rel="stylesheet" href="Content/css/m.css">
    <link rel="stylesheet" href="Content/css/m_web.css">
    <link rel="stylesheet" type="text/css" href="Content/css/zfk.css">
    <script src="Content/js/jquery-2.2.4.min.js"></script>
    <script src="Content/js/layer-mobl.js"></script>
</head>
<body>
<div class="page">
    <div id="buyWrap">
        <div class="delivery_wrap">
            <div class="delivery_no_address">请填写收货地址</div>
            <div class="delivery_content" style="display: none">
                <div style="float:left;width:40px;font-weight:bold;color:#fff;">送至</div>
                <div style="margin-left:40px;overflow:hidden;color:#fcfcfc" id="addressinfo"></div>
            </div>
        </div>
        <div class="delivery_date">
        <strong>送达时间：</strong>
        <div class="shsj">
            <div data-key="周一送达">周一送达<p>首次8月22号</p></div>
            <div data-key="周六送达">周六送达<p>首次8月27号</p></div>
        </div>
    </div>
        <div class="pinfo-wrap">
            <div class="pinfo-image"><img src="Content/img/zhutu160801.jpg!sml"></div>
            <div class="pinfo-content">
                <div class="pinfo-title">混合花束单次体验</div>
                <div class="pinfo-sku">一次</div>
            </div>
            <div class="pinfo-price">￥0</div>
        </div>
        <div class="dhmbox"><input type="tel" placeholder="输入兑换码" maxlength="6" class="dhm"></div>


        <div class="padding_15" style="border-top:0 none">
            <ul id="comfirm-fee">
                <li>商品总额:<span class="confirm-price" id="totalfee">￥0</span></li>
            </ul>
        </div>

        <div style="margin:20px 0 0 0;text-align:center;font-weight:bold">付款金额: <span class="confirm-price" id="payment">￥00</span></div>
        <a id="payandsubmit" href="javascript:;">确认下单</a>
        <div style="text-align: center;"><img src="Content/img/ucenterlogo.png" style="width: 60%;margin-bottom: 10px;"></div>
    </div>
    <!--BEGIN 选择地址-->
    <div class="Shipping_ads" style="display:none">
        <div class="deliver-address-title" style="padding:18px 0;font-weight: normal;font-size: 18px;height:auto;line-height:18px">收货地址
            <a class="deliver-close" href="javascript:;"></a>
        </div>

        <div id="deliver-address-con1" style="display:block">
            <dl class="deliver-item">
                <dt>收货人</dt>
                <dd><input type="text" id="receiver_name" placeholder="姓名">  </dd>
            </dl>
            <dl class="deliver-item">
                <dt>手机</dt>
                <dd><input type="tel" id="receiver_mobile" placeholder="收货人手机"> </dd>
            </dl>
            <dl class="deliver-item">
                <dt>所在地区</dt>
                <dd class="address_area">
                    <select class="form-control" id="receiver_state" name="receiver_state">
                        <option  value="选择省份">选择省份</option>
                        <option  value="上海">上海</option>
                        <option  value="北京">北京</option>
                        <option value="天津">天津</option>
                        <option  value="江苏">江苏</option>
                        <option value="浙江">浙江</option>
                        <option value="广东">广东</option>
                        <option  value="河北">河北</option>
                        <option  value="山东">山东</option>
                        <option  value="安徽">安徽</option>
                        <option  value="四川">四川</option>
                    </select>
                    <select class="form-control" id="receiver_city" name="receiver_city">
                        <option  value="选择城市">选择城市</option>
                        <option  value="河北">河北</option>
                        <option value="山东">山东</option>
                        <option  value="安徽">安徽</option>
                        <option  value="四川">四川</option>
                    </select>
                    <select class="form-control" id="receiver_district" name="receiver_district">
                        <option  value="选择区县">选择区县</option>
                        <option  value="上海">上海</option>
                        <option  value="北京">北京</option>
                        <option  value="天津">天津</option>
                        <option  value="江苏">江苏</option>

                    </select>
                </dd>
            </dl>
            <dl class="deliver-item">
                <dt>详细地址</dt>
                <dd><input type="text" id="receiver_address" placeholder="街道门牌信息"></dd>
            </dl>
            <!-- <p style="color:#999;padding:5px 15px">目前开通的区域为江浙沪、北京、广东和四川。</p> -->
            <div class="deliver-save-wrap"><button class="deliver-save">保存</button></div>
            <dl class="address_log">
                <dt>历史</dt>
            </dl>
        </div>
    </div>
    <div class="weui_dialog_confirm" style="display: none">
        <div class="weui_mask"></div>
        <div class="weui_dialog">
            <div class="weui_dialog_hd"><strong class="weui_dialog_title">确认地址和手机准确吗？</strong></div>
            <div class="weui_dialog_bd"></div>
            <div class="weui_dialog_ft">
                <a href="javascript:void(0)" class="weui_btn_dialog default" id="qx">取消</a>
                <a href="javascript:void(0)" class="weui_btn_dialog primary" id="qd">确定</a>
            </div>
        </div>
    </div>
    <!--END 选择地址-->
</div>
<script type="text/javascript">
    $(".delivery_date .shsj div").on('click',function(){
        $(this).addClass("select").siblings().removeClass("select");
    });
    $("#payandsubmit").on("click",function(){
        var btn=$(this);
        var adds=$("#addressinfo").html();
        if(adds===""|| adds.length===0){
            layer.open({
                content: '请填写收货地址！',
                time: 1
            });
            return false;
        }
        if($(".shsj div").hasClass('select')){

        }else {
            layer.open({
                content: '请选择送达日期！',
                time: 1
            });
            return false;
        }

        var content=$(".dhm").val();
        //var name=$("#e_txtZhuFu_name").val();

            if (content.length === 0 || content.length < 1) {
                layer.open({
                    content: "请填写兑换码！",
                    time: 1
                });
                return false;
            }

        btn.attr("data-runing",1);
        btn.html("正在创建订单，请稍候").addClass("buttondisabled");
    });

    $("body").delegate("input[type='tel']","input",function(){$(this).val($(this).val().replace(/[^0-9]/g,'').replace(/^86/,''))});

    var total_scores=0;
    $("#btnQuan").on("click",function(e){e.stopPropagation();$("#quanWrap").addClass("right-dialog-show");$('body,html').css({"overflow":"hidden"});return false;});
    $("#btnMa").on("click",function(e){e.stopPropagation();$("#maWrap").addClass("right-dialog-show");return false;});
    $(".right-dialog-close").on("click",function(e){e.stopPropagation();$(".right-dialog").removeClass("right-dialog-show");$('body,html').css({"overflow":""});return false;});
    var adds=[];
    var selectedAddress={};
    //        $.address_b.list[0]={n:'选择省份',c:[{n:'选择城市',a:['选择区县']}]};
    //        $.address_b("receiver_state","receiver_city","receiver_district");
    $(".delivery_wrap").on("click",function(e){e.stopPropagation();$("#buyWrap").hide();$(".Shipping_ads").show();return false;});
    $(".deliver-close").on("click",function(e){e.stopPropagation();$("#buyWrap").show();$('body,html').scrollTop(0);$(".Shipping_ads").hide();});
    $(".deliver-save").on("click",function(e){
        e.stopPropagation();
        var receiver_name = $("#receiver_name").val().replace('/^\s|\s$/g','');
        var receiver_mobile = $("#receiver_mobile").val().replace('/^\s|\s$/g','');
        var receiver_state = $("#receiver_state").val();
        var receiver_city = $("#receiver_city").val();
        var receiver_district = $("#receiver_district").val();
        var receiver_address = $("#receiver_address").val().replace('/^\s|\s$/g','');
        var address={
            receiver_name:receiver_name,
            receiver_mobile:receiver_mobile,
            receiver_state:receiver_state,
            receiver_city:receiver_city,
            receiver_district:receiver_district,
            receiver_address:receiver_address
        };
        if(address.receiver_name===""){
            layer.open({
                content:"请填写收货人姓名",
                time:1
            });
            return false;
        }else if(address.receiver_mobile===""){
            layer.open({
                content:"请填写收货人手机",
                time:1
            });
            return false;
        } else if(!/^1\d{10}$/.test(address.receiver_mobile)){
            layer.open({
                content:"收货人手机号错误",
                time:1
            });
            return false;
        } else if(address.receiver_state==="" || address.receiver_state==="选择省份"){
            layer.open({
                content:"请选择省份",
                time:1
            });
            return false;
        }else if(address.receiver_city==="" || address.receiver_city==="选择城市"){
            layer.open({
                content:"请选择城市",
                time:1
            });
            return false;
        }else if(address.receiver_district==="" || address.receiver_district==="选择区县"){
            layer.open({
                content:"请选择区县",
                time:1
            });
            return false;
        }else if(address.receiver_address===""){
            layer.open({
                content:"请填写详细地址",
                time:1
            });
            return false;
        }
        $(".weui_dialog_confirm").show();
        $('.weui_dialog_bd').html('\n'+receiver_state+receiver_city+receiver_district+receiver_address+'<br>'+receiver_name+'<br>'+receiver_mobile);
//            $.post('/buy/addaddress',address,function(v){
//                if(v.f){
//                    //getAddress();
//                    $("#receiver_name").val("");
//                    $("#receiver_mobile").val("");
//                    $("#receiver_address").val("");
//                    $.address_b("receiver_state","receiver_city","receiver_district");
//                    adds=v.list;
//                    updateAddressList();
//                    selectAddress(v.id);
//
//                }else{
//                    showerror(v.data);
//                }
//                btn.prop("disabled",false);
//            },"json");
    });

    $("#qx").on('click',function () {
        $(".weui_dialog_confirm").hide();
    });


    //点击地址页保存按钮弹出后的确定按钮
    $("#qd").on('click',function () {
        var receiver_name = $("#receiver_name").val().replace('/^\s|\s$/g','');
        var receiver_mobile = $("#receiver_mobile").val().replace('/^\s|\s$/g','');
        var receiver_state = $("#receiver_state").val();
        var receiver_city = $("#receiver_city").val();
        var receiver_district = $("#receiver_district").val();
        var receiver_address = $("#receiver_address").val().replace('/^\s|\s$/g','');
        //alert();
        $('.address_log dd').removeClass("add-sel");
        $('.address_log dt').after("<dd class='add-sel'><div class='adddz'>"+receiver_state+receiver_city+receiver_district+receiver_address+"</div><div><span class='receiver_name'>"+receiver_name+"</span>&nbsp;<span class='receiver_mobile'>"+ receiver_mobile+"</span></div> </dd>");
        $(".weui_dialog_confirm").hide();
        $(".Shipping_ads").hide();
        $("#buyWrap").show();
        $(".delivery_no_address").hide();
        $(".delivery_content").show();
        claerAdd();
        $('#addressinfo').html(receiver_state+receiver_city+receiver_district+receiver_address+"<br>"+receiver_name+"&nbsp;"+ receiver_mobile);
    });

    $(".address_log").delegate( ' dd','click',function (e) {
        var receiver_name = $(this).find('.receiver_name').html();
        var receiver_address = $(this).find('.adddz').html();
        var receiver_mobile= $(this).find('.receiver_mobile').html();
        //alert(receiver_address);
        $(this).addClass("add-sel").siblings().removeClass("add-sel");
        $(".Shipping_ads").hide();
        $("#buyWrap").show();
        $(".delivery_no_address").hide();
        $(".delivery_content").show();
        $('#addressinfo').html(receiver_address+"<br>"+receiver_name+"&nbsp;"+ receiver_mobile);
        claerAdd();
    });
    $( '.address_log dd').on('click',function (e) {
        var receiver_name = $(this).find('.receiver_name').html();
        var receiver_address = $(this).find('.adddz').html();
        var receiver_mobile= $(this).find('.receiver_mobile').html();
        //alert(receiver_address);
        $(this).addClass("add-sel").siblings().removeClass("add-sel");
        $(".Shipping_ads").hide();
        $("#buyWrap").show();
        $(".delivery_no_address").hide();
        $(".delivery_content").show();
        $('#addressinfo').html(receiver_address+"<br>"+receiver_name+"&nbsp;"+ receiver_mobile);
        claerAdd();
    });
    //清空地址
    function claerAdd() {
        var receiver_name = $("#receiver_name").val("");
        var receiver_mobile = $("#receiver_mobile").val("");
        var receiver_state = $("#receiver_state").val("选择省份");
        var receiver_city = $("#receiver_city").val("选择城市");
        var receiver_district = $("#receiver_district").val("选择区县");
        var receiver_address = $("#receiver_address").val("");
    }
</script>

<!--END 积分优惠券抵扣-->
</body>
</html>
